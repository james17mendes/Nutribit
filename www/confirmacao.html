<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">

    <title></title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css ">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <!--Material design-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">

</head>
<body>


    <style>
        .mostra {
            display: normal;
        }

        .esconde {
            display: none;
        }

        .aparece {
            display: normal;
        }

        .desaparece {
            display: none;
        }

        html {
            margin: 0;
            height: 100%;
        }

        body {
            height: 100%;
            overflow: scroll;
        }

        ul.dropdown-cart {
            min-width: 250px;
        }

            ul.dropdown-cart li .item {
                display: block;
                padding: 3px 10px;
                margin: 3px 0;
            }

                ul.dropdown-cart li .item:hover {
                    background-color: #f3f3f3;
                }

                ul.dropdown-cart li .item:after {
                    visibility: hidden;
                    display: block;
                    font-size: 0;
                    content: " ";
                    clear: both;
                    height: 0;
                }

            ul.dropdown-cart li .item-left {
                float: left;
            }

                ul.dropdown-cart li .item-left img,
                ul.dropdown-cart li .item-left span.item-info {
                    float: left;
                }

                ul.dropdown-cart li .item-left span.item-info {
                    margin-left: 10px;
                }

                    ul.dropdown-cart li .item-left span.item-info span {
                        display: block;
                    }

            ul.dropdown-cart li .item-right {
                float: right;
            }

                ul.dropdown-cart li .item-right button {
                    margin-top: 14px;
                }



        .avatar {
            width: 30px;
            border-radius: 50%;
        }

        .navbar-default {
            background-color: forestgreen;
        }

        .blackbox {
            background-color: #404040;
            margin-top: 20px;
        }

        .greenbox {
            background-color: forestgreen;
            margin-top: 20px;
        }

        .fa1 {
            font-size: 150px;
        }

        .effect:hover {
            opacity: 0.9;
            transform: scale(1.1)
        }

        .custom-toggler .navbar-toggler-icon {
            background-image: url("data:image/svg+xml;charset=utf8,%3Csvg viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath stroke='rgba(255,102,203, 0.5)' stroke-width='2' stroke-linecap='round' stroke-miterlimit='10' d='M4 8h24M4 16h24M4 24h24'/%3E%3C/svg%3E");
        }

        .custom-toggler.navbar-toggler {
            border-color: rgb(255,102,203);
        }

        .title {
            color: forestgreen;
        }

        .borderless td, .borderless th {
            border: none;
        }

        .nav .open > a, .nav .open > a:focus, .nav .open > a:hover {
            background-color: transparent
        }



        .fade {
            opacity: 0.5;
        }

            .fade:hover {
                opacity: 1;
            }

        .div1 {
            background-color: forestgreen;
            color: white;
            margin-left: 150px;
            width: 80%;
            margin-top: 40px;
            border-radius: 10px
        }

        .ch1 {
            color: forestgreen;
            margin-left: 150px
        }

        .ch2 {
            margin-top: 20px;
            background-color: #404040;
            color: white;
            margin-left: 200px;
            border-radius: 15px
        }

        .ch3 {
            background-color: dodgerblue;
            margin-left: 100px;
            margin-top: 18px;
            border-radius: 15px;
            color: white
        }

        @media screen and (max-width: 600px) {
            .ch3 {
                margin-left: 5%;
                max-width: 90%;
                margin-bottom:5%;
            }
        }

        @media screen and (max-width: 600px) {
            .ch2 {
                margin-left: 5%;
                max-width:90%;
            }
        }

        @media screen and (max-width: 600px) {
            .ch1 {
                margin-left:0px;
                text-align:center;
            }
        }

        @media screen and (max-width: 600px) {
            .div1 {
                margin-right: 5%;
                margin-left: 10%;
                margin-top: 70%;
                
            }
        }

        @media screen and (max-width: 600px) {
            .div2 {
                margin-right: 10%;
                margin-left: 10%;
                margin-bottom: 5%;
            }
        }

    </style>


    <nav class="navbar  navbar-fixed-top" style="background-color:forestgreen;position:relative;margin-bottom:0px">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button style="border-color:blue" type="button" class="navbar-toggle  navbar-dark collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only ">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand"><img src="images/Logo2.png"></a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">





                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">




                        <a style="color:white;transition:0.3s" href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span id="nome"></span>       <img src="images/sad.png" alt="Avatar" class="avatar"></a>



                        <ul style="background-color:black" class="dropdown-menu dropdown-cart" role="menu">
                            <li>
                                <a style="color:white;float:right;transition:0.3s" href="perfil.html">Perfil <i class="fa fa-user" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a style="color:white;float:right;transition:0.3s" href="planear.html">As minhas refeições <i class="fa fa-cutlery" aria-hidden="true"></i></a>
                            </li>
                            <li>
                                <a style="color:white;float:right;transition:0.3s" href="promocao.html">Códigos Promocionais <i class="fa fa-tag"></i></a>
                            </li>
                            <li>
                                <a id="sair" style="color:white;float:right;transition:0.3s" href="home.html">Sair <i class="fa fa-sign-out" aria-hidden="true"></i></a>
                            </li>
                        </ul>
                    </li>
                </ul>





                <ul class="nav navbar-nav navbar-right">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false" style="color:white;font-size:30px"> <span class="glyphicon glyphicon-shopping-cart"></span>  </a>
                        <ul class="dropdown-menu dropdown-cart" role="menu" style="background-color:black">
                            <li id="order1" class="mostra">
                                <span class="item">
                                    <span class="item-info">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName1">Não há pedidos</span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice1"></span>
                                        </span>
                                    </span>
                                </span>
                            </li>
                            <li id="divider1" class="divider mostra"></li>
                            <li id="order2" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"> <span id="orderName2"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice2"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider2" class="divider esconde"></li>
                            <li id="order3" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName3"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice3"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider3" class="divider esconde"></li>
                            <li id="order4" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName4"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice4"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider4" class="divider esconde"></li>
                            <li id="order5" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName5"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice5"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider5" class="divider esconde"></li>
                            <li id="order6" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName6"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice6"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider6" class="divider esconde"></li>
                            <li id="order7" class="esconde">
                                <span class="item">
                                    <span class="item-left">
                                        <span class="item-info">
                                            <span style="color: white; font-size:15px;"><span id="orderName7"></span></span>
                                            <span style="color: white; font-size:15px;" id="orderPrice7"></span>
                                        </span>
                                    </span>
                                    <span class="item-right">
                                        <i style="font-size:40px; color:white;" class="fa fa-check-circle"></i>
                                    </span>
                                </span>
                            </li>
                            <li id="divider7" class="divider esconde"></li>
                        </ul>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right">

                    <li style="margin-top:15px">
                        <span id="bits" style="color:white;font-size:20px"></span><span style="color:white;font-size:20px"> bits</span>
                        <img style="width:40px" src="images/logo3.png">
                    </li>


                </ul>

            </div><!-- /.navbar-collapse -->
        </div><!-- /.container-fluid -->
    </nav>


    <div class="container col-lg-12" style="background-color:forestgreen;float:left;color:white;position:relative;width:100%">
        <h2 class="col-lg-10"><i class="fa fa-arrow-circle-right"></i> Encomendar</h2>
        <span class="col-lg-2" style="font-size:40px;color:white;margin-top:30px"><i class="fa fa-arrow-circle-o-left " aria-hidden="true"></i> <a href="Encomenda3.html" style="color:white;text-decoration:none">Voltar</a></span>
    </div>

    <div class="container col-lg-12 div1" style="">
        <h3 class="col-lg-10"><i style="font-size:40px;" class="fa fa-barcode"></i> Pagamento</h3>

    </div>

    <h3 class="col-lg-8 ch1" style="">Confirme a sua encomenda e efetue o pagamento:</h3>

    <div class="col-lg-5 ch2" style="">
        <h5 class="col-lg-8" style="padding-right:0px"> Informação da encomenda:  </h5>
        
        <h5 class="col-lg-7" style="padding-right:0px;margin-top:0"><i class="fa fa-arrow-circle-right"></i> <span id="meal"></span> (<span id="preco1"></span> €)</h5>
        <h5 class="col-lg-4" style="padding-right:0px;margin-top:0"><i class="fa fa-arrow-circle-right"></i> Bebida (<span id="preco2"></span> €)</h5>
        <h6 class="col-lg-7" style="padding-right:0px;margin-top:10px"> <b>Ingredientes :</b> </h6>
        <ul class="col-lg-4" style="margin-left:20px">
            <li id="drink"></li>
        </ul>
        <ul class="col-lg-5" style="margin-left:20px">
            <li id="i1" class="desaparece"></li>
            <li id="i2" class="desaparece"></li>
            <li id="i3" class="desaparece"></li>
            <li id="i4" class="desaparece"></li>
            <li id="i5" class="desaparece"></li>
        </ul>
        <h6 class="col-lg-6">Local de entrega: <span id="entrega"></span><br /> Tipo de pagamento: <span id="pagamento"></span></h6>
       
        <div class="col-lg-2">
            <button id="alterar" style="background-color:dodgerblue;color:white;margin-top:20px" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent button_1  ">
                Alterar
            </button>
        </div>
        </div>


    <div class="col-lg-2 ch3" style="">
        <h4 class="col-lg-12" style="padding-right:0px;text-align:center"> Pagamento:</h4>
        <h5 class="col-lg-12" style="padding-right:0px;margin-top:10px"> Base: <span id="base"></span> €</h5>
        <h5 class="col-lg-8" style="padding-right:0px;margin-top:10px"> Desconto: </h5>
        <input class="col-lg-4" style="color:black;" id="desconto" type="number" name="quantity">
        <h5 class="col-lg-12" style="padding-right:0px;margin-top:10px"> Total: <span id="total"></span> €</h5>

        <div class="col-lg-12">
            <button id="pagar" style="background-color:red;color:white;margin-top:10px;margin-bottom:10px;margin-left:50px" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent button_1  ">
                Pagar
            </button>
        </div>

    </div>





    <script type="text/javascript" src="cordova.js"></script>
    <script src="../js/InputSpinner.js"></script>
    <script>
        $(document).ready(function () {

            var currentUser = JSON.parse(localStorage.getItem("currentUser"));
            var currentOrder = JSON.parse(localStorage.getItem("currentOrder"));

            $("#nome").html("" + currentUser.name);
            $("#bits").html("" + currentUser.bits);
            currentOrder.total = currentOrder.meal.preco + currentOrder.drink.preco;
            $("#total").html(currentOrder.meal.preco + currentOrder.drink.preco);

            $("#meal").html("" + currentOrder.meal.nome);
            $("#preco1").html("" + currentOrder.meal.preco);
            $("#preco2").html("" + currentOrder.drink.preco);
            $("#entrega").html("" + currentOrder.entrega);
            $("#pagamento").html("" + currentOrder.pagamento);
            $("#base").html("" + (currentOrder.meal.preco + currentOrder.drink.preco));
            for (var i = 0; i < currentOrder.meal.ingredientes.length; i++) {
                $("#i" + (i + 1)).removeClass("desaparece").addClass("aparece").html("" + currentOrder.meal.ingredientes[i]);
            }

            if ((currentUser.bits / 100) <= currentOrder.meal.preco + currentOrder.drink.preco) {
                $("#desconto").attr('min', 0).attr('max', (currentUser.bits / 100));
            } else {
                $("#desconto").attr('min', 0).attr('max', currentOrder.meal.preco + currentOrder.drink.preco);
            }

            $("#desconto").change(function () {
                currentOrder.total = (currentOrder.meal.preco + currentOrder.drink.preco) - $("#desconto").val();
                $("#total").html(currentOrder.total);
            });

            $("#drink").html("" + currentOrder.drink.nome);

            $("#alterar").click(function () {
                window.location = "Encomenda1.html";
            });

            var users = JSON.parse(localStorage.getItem('users'));

            $("#pagar").click(function () {
                currentUser.bits = currentUser.bits - $("#desconto").val() * 100;
                for (var i = 0; i < users.length; i++) {
                    if (currentUser.email == users[i].email) {
                        users[i] = currentUser;
                        break;
                    }
                }
                currentUser.orders.push(currentOrder);
                localStorage.setItem('users', JSON.stringify(users));
                localStorage.setItem('currentOrder', JSON.stringify(currentOrder));
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                window.location = "Encomenda4.html";
            });

        });
    </script>
    <script src="../js/shoppingCart.js"></script>


</body>
</html>